<!DOCTYPE html>
<html lang="da" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Fødevarer til afhentning</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>

<header class="topbar">
    <h1>Fødevarer til afhentning</h1>
    <p class="subtitle">Opret, redigér og fjern overskydende mad</p>
</header>

<main class="container">

    <!-- Filtre -->
    <form method="get" class="card filters">
        <label class="chip">
            <input type="checkbox" name="category" value="vegansk"
                   th:checked="${activeCategories.contains('vegansk')}"> <span>Vegansk</span>
        </label>

        <label class="chip">
            <input type="checkbox" name="category" value="vegetarisk"
                   th:checked="${activeCategories.contains('vegetarisk')}"> <span>Vegetarisk</span>
        </label>

        <label class="chip">
            <input type="checkbox" name="category" value="andet"
                   th:checked="${activeCategories.contains('andet')}"> <span>Andet</span>
        </label>

        <input class="search" type="search" name="q" placeholder="Søg…" th:value="${q}">
        <button class="btn primary" type="submit">Filtrér</button>
    </form>

    <!-- Formular -->
    <section class="card">
        <h2 th:text="${form.id} != null ? 'Redigér fødevare' : 'Opret fødevare'"></h2>

        <form action="/save" method="post" class="form">
            <input type="hidden" name="id" th:value="${form.id}">

            <div class="grid">
                <label>
                    <span>Navn</span>
                    <input name="name" th:value="${form.name}" required placeholder="Fx 'Rugbrød – 2 stk.'">
                </label>

                <label>
                    <span>Antal (stk/portioner)</span>
                    <input type="number" name="qty" min="1" step="1" th:value="${form.qty ?: 1}" required>
                </label>

                <label>
                    <span>Antal kg</span>
                    <input type="number" name="kg" step="0.1" min="0" th:value="${form.kg}">
                </label>

                <label>
                    <span>Pris (kr)</span>
                    <input type="number" name="price" step="0.5" min="0" th:value="${form.price}">
                </label>

                <label>
                    <span>Kategori</span>
                    <select name="category" th:value="${form.category}">
                        <option value="vegansk">Vegansk</option>
                        <option value="vegetarisk">Vegetarisk</option>
                        <option value="andet">Andet</option>
                    </select>
                </label>

                <label>
                    <span>Afhentningstid</span>
                    <input type="datetime-local" name="pickup"
                           th:value="${form.pickup != null ? form.pickup.toString().substring(0,16) : ''}">
                </label>

                <label class="full">
                    <span>Beskrivelse</span>
                    <textarea name="desc" rows="2" placeholder="Allergener, bedst før, osv."
                              th:text="${form.desc}"></textarea>
                </label>
            </div>

            <div class="actions">
                <button class="btn primary" type="submit">Gem</button>
                <a href="/" class="btn ghost">Nulstil</a>
            </div>
        </form>
    </section>

    <!-- Liste -->
    <section class="card">
        <div class="list-head">
            <h2>Tilgængelige fødevarer</h2>
            <small id="count" th:text="${count + ' element' + (count == 1 ? '' : 'er')}"></small>
        </div>

        <ul class="list">
            <li class="item" th:each="f : ${items}">
                <!-- Navn + beskrivelse (beskrivelse nederst) -->
                <div>
                    <h3 th:text="${f.name}">Navn</h3>
                    <div class="meta desc" th:text="${f.desc}">Beskrivelse</div>
                </div>

                <!-- Kategori -->
                <div class="badge" th:text="${f.category}">kategori</div>

                <!-- Antal -->
                <div class="qty">Antal: <strong th:text="${f.qty}">1</strong></div>

                <!-- Kg -->
                <div class="qty">Kg: <strong th:text="${f.kg}">0</strong></div>

                <!-- Pris -->
                <div class="qty">Pris: <strong th:text="${f.price}">0</strong> kr</div>

                <!-- Afhentning -->
                <div class="pickup"
                     th:text="${f.pickup != null ? #temporals.format(f.pickup,'dd/MM HH:mm') : 'Ingen tid'}">
                    01/01 12:00
                </div>

                <!-- Knapper -->
                <div class="controls">
                    <a class="btn small" th:href="@{'/edit/' + ${f.id}}">Redigér</a>
                    <form th:action="@{'/delete/' + ${f.id}}" method="post"
                          onsubmit="return confirm('Slet dette?')">
                        <button class="btn small warn" type="submit">Slet</button>
                    </form>
                </div>
            </li>
        </ul>
    </section>

</main>

<footer class="footer">
    <small>Grønt tema • Thymeleaf • ingen JS</small>
</footer>

</body>
</html>
